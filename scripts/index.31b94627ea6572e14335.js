!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(i,r,function(t){return e[t]}.bind(null,r));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=16)}([function(e,t,s){},function(e,t,s){e.exports=s.p+"./images/tile.png"},function(e,t,s){e.exports=s.p+"./images/field.png"},function(e,t,s){e.exports=s.p+"./images/moves.png"},function(e,t,s){e.exports=s.p+"./images/bar_back.png"},function(e,t,s){e.exports=s.p+"./images/bar.png"},function(e,t,s){e.exports=s.p+"./images/score_panel.png"},function(e,t,s){e.exports=s.p+"./images/top_panel.png"},function(e,t,s){e.exports=s.p+"./images/background.png"},function(e,t,s){e.exports=s.p+"./images/progress_panel.png"},function(e,t,s){e.exports=s.p+"./images/pause_base.png"},function(e,t,s){e.exports=s.p+"./images/pause_hover.png"},function(e,t,s){e.exports=s.p+"./images/pause_press.png"},function(e,t,s){e.exports=s.p+"./images/button2_base.png"},function(e,t,s){e.exports=s.p+"./images/button2_hover.png"},function(e,t,s){e.exports=s.p+"./images/button2_press.png"},function(e,t,s){"use strict";s.r(t);s(0);class i{constructor(e){this._ctx=e,this._x=0,this._y=0,this._dx=0,this._dy=0,this._width=0,this._height=0,this._anchorX=0,this._anchorY=0,this._background=void 0,this._alpha=1,this._borders={leftTop:0,rightTop:0,leftBottom:0,rightBottom:0},this._hitbox={left:0,right:0,top:0,bottom:0},this._clickHandler=void 0,this._pressHandler=void 0,this._releaseHandler=void 0,this._hoverHandler=void 0,this._hoverInHandler=void 0,this._hoverOutHandler=void 0,this._removeHandler=void 0,this._isPressed=!1,this._isHovered=!1,this._eEnabled=!0,this._serialTaskQueue=[],this._parallelTaskQueue=[]}setContext(e){this._ctx=e}setPosition(e,t){this._x=e,this._y=t,this._refresh()}_refresh(){this._dx=this._x-this._width*this._anchorX,this._dy=this._y-this._height*this._anchorY,this._borders.leftTop=this._dx,this._borders.leftTop=this._dx;const e=this._width*this._anchorX,t=this._height*this._anchorY;this._x,this._width,this._hitbox.left,this._x,this._width,this._width,this._hitbox.right,this._y,this._height,this._hitbox.top,this._y,this._height,this._height,this._hitbox.bottom}getPosition(){return{x:this._x,y:this._y}}setX(e){this._x=e,this._refresh()}setY(e){this._y=e,this._refresh()}setSize(e,t){this._width=e,this._height=t,this._refresh()}getSize(){return{width:this._width=width,height:this._height=height}}setAnchor(e,t){this._anchorX=e,this._anchorY=t,this._refresh()}setHitbox(e,t,s,i){this._hitbox.left=e,this._hitbox.right=t,this._hitbox.top=s,this._hitbox.bottom=i}setBackgroundImage(e){this._background=e}resizeOnBackground(){this._width=this._background.width,this._height=this._background.height,this._refresh()}scaleOnBackground(e){this._width=this._background.width*e,this._height=this._background.height*e,this._refresh()}scaleOnBackgroundWidth(e){const t=e/this._background.width;this.scaleOnBackground(t)}scaleOnBackgroundHeight(e){const t=e/this._background.height;this.scaleOnBackground(t)}_isHit(e,t){const s=this._dx+this._width*this._hitbox.left,i=this._dx+this._width-this._width*this._hitbox.right,r=this._dy+this._height*this._hitbox.top,h=this._dy+this._height-this._height*this._hitbox.bottom;return!!(e>=s&&e<i&&t>=r&&t<h)}onPress(e,t){this._isHit(e,t)&&(this._isPressed=!0,this._pressHandler&&this._eEnabled&&this._pressHandler(this))}onRelease(e,t){this._isPressed&&(this._isPressed=!1,this._releaseHandler&&this._eEnabled&&this._releaseHandler(this),this._isHit(e,t)&&this._eEnabled&&this._onClick())}onMove(e,t){let s=this._isHit(e,t);this._isHovered||!s?!this._isHovered||s?this._isHovered&&s&&this._hoverHandler&&this._eEnabled&&this._hoverHandler():this._hoverOutHandler&&this._eEnabled&&(this._isHovered=!1,this._hoverOutHandler()):this._hoverInHandler&&this._eEnabled&&(this._isHovered=!0,this._hoverInHandler())}_onClick(){this._clickHandler&&this._eEnabled&&this._clickHandler(this)}onRemove(){this._removeHandler&&this._eEnabled&&this._clickHandler(this)}setClickHandler(e){this._clickHandler=e}setRemoveHandler(e){this._removeHandler=e}setHoverInHandler(e){this._hoverInHandler=e}setHoverOutHandler(e){this._hoverOutHandler=e}setHoverHandler(e){this._hoverHandler=e}setPressHandler(e){this._pressHandler=e}setReleaseHandler(e){this._releaseHandler=e}addParallelTask(e){this._parallelTaskQueue.push(e)}addSerialTask(e){this._serialTaskQueue.push(e)}getSerialQueueSize(){return this._serialTaskQueue.length}getParallelQueueSize(){return this._parallelTaskQueue.length}disableEvents(){this._eEnabled=!1}enableEvents(){this._eEnabled=!0}render(){this._ctx.globalAlpha=this._alpha,this._parallelTaskQueue.forEach(e=>{e(this)&&(this._parallelTaskQueue=this._parallelTaskQueue.filter(t=>t!=e))}),this._serialTaskQueue.length>0&&this._serialTaskQueue[0](this)&&this._serialTaskQueue.shift(),null!=this._background&&this._ctx.drawImage(this._background,this._dx,this._dy,this._width,this._height),this._ctx.globalAlpha=this.alpha}}function r(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}class h extends i{constructor(e,t=14,s="#00",i="serif",r=""){super(e),this._fontsize=t,this._font=i,this._baseline="middle",this._textcolor=s,this.setText(r)}setText(e){this._text=e.toString()}render(){super.render(),this._ctx.font=`${this._fontsize}px ${this._font}`,this._ctx.fillStyle=this._textcolor,this._ctx.textBaseline=this._baseline;let e=this._ctx.measureText(this._text),t=this._x+(this._width-e.width)/2,s=this._y+this._height/2;t-=this._width*this._anchorX,s-=this._height*this._anchorY,this._ctx.fillText(this._text,t,s)}}class n extends h{constructor(e,t=14,s="#00",i="serif",r=""){super(e,t,s,i,r),this._baseImg=void 0,this._hoverImg=void 0,this._pressImg=void 0,this.setHoverInHandler(()=>{!this._isPressed&&this._hoverImg&&this.setBackgroundImage(this._hoverImg)}),this.setHoverOutHandler(()=>{!this._isPressed&&this._baseImg&&this.setBackgroundImage(this._baseImg)}),this.setPressHandler(()=>{this._pressImg&&this.setBackgroundImage(this._pressImg)}),this.setReleaseHandler(()=>{this._isHovered?this.setBackgroundImage(this._hoverImg):this.setBackgroundImage(this._baseImg)})}setBaseImage(e){this._baseImg=e,this.setBackgroundImage(e)}setHoverImage(e){this._hoverImg=e}setPressImage(e){this._pressImg=e}}class o extends n{constructor(e,t=14,s="#00",i="serif",r=""){super(e,t,s,i,r),this._isFixed=!1}getState(){return this._isFixed}fix(){this._isFixed=!0}reset(){this._isFixed=!1,this.setBackgroundImage(this._baseImg)}_onClick(){this._isFixed=!this._isFixed,super._onClick()}render(){this._isFixed&&this.setBackgroundImage(this._pressImg),super.render()}}function a(e){return new Promise((t,s)=>{const i=new Image;i.addEventListener("load",()=>t(i)),i.addEventListener("error",e=>{s(e),console.log(e)}),i.src=e})}function l(e,t=0,s=0,i=0){const r=document.createElement("canvas"),h=r.getContext("2d");let n=void 0,o=void 0;r.width=e.width,r.height=e.height,h.drawImage(e,0,0),o=h.getImageData(0,0,r.width,r.height).data;for(let e=0,r=o.length;e<r;e+=4)o[e]-=t,o[e+1]-=s,o[e+2]-=i;const l=new ImageData(o,r.width,r.height);return h.putImageData(l,0,0),n=a(r.toDataURL("image/png",1)),n}const _=[0,.109375];function d(e,t){if(t<0||void 0===t)return;const s=new i;return s.setBackgroundImage(e[t]),s.resizeOnBackground(),s.setAnchor(..._),s}function c(e,t,s,i){let r=void 0,h=void 0;return n=>{null==r&&(r=n._x<e?1:-1,h=n._y<t?1:-1);let o=n.getPosition();return o.x+=r*(s+i)/60,o.y+=h*(s+i)/60,n.setPosition(o.x,o.y),o.x*r>e*r&&n.setX(e),o.y*h>t*h&&n.setY(t),n._x==e&&n._y==t}}var u=document.querySelector(".main"),g={isPressed:!1,isRemoving:!1,isMoving:!1,isShuffling:!1,isBoosted:!1,isSupercell:!1,target:void 0,address:void 0,group:[],changes:void 0,moves:50,score:0,shuffles:3,boosters:2},p=void 0,f=void 0,x=new class{constructor(e,t,s,i){this._container=e,this._canvas=document.createElement("canvas"),this._canvas.width=t,this._canvas.height=s,this._ctx=this._canvas.getContext("2d"),this._renderQueue=[],this._taskQueue=[],this._stopEngine=!0,this._background_color=i,this._background_image=void 0,this._canvas.textContent="Sorry, but your browser is not supported :(",this._canvas.addEventListener("mousedown",e=>this._mouseDown(e)),this._canvas.addEventListener("mouseup",e=>this._mouseUp(e)),this._canvas.addEventListener("mousemove",e=>this._mouseMove(e)),this.deploy()}getContext(){return this._ctx}deploy(){this._container.appendChild(this._canvas)}setBackgroundImage(e){this._background_image=e}retract(){this._container.removeChild(this._canvas)}clear(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._background_image?this._ctx.drawImage(this._background_image,0,0,this._canvas.width,this._canvas.height):this._background_color&&(this._ctx.fillStyle=this._background_color,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}addLayer(e){this._renderQueue.push(e)}addTask(e){this._taskQueue.push(e)}renderEngineStart(){this._stopEngine=!1,this._renderStep()}renderEngineStop(){this._stopEngine=!0}_renderStep(){this._stopEngine||(this._taskQueue.forEach(e=>e()),this.clear(),this._renderQueue.forEach(e=>e.render()),requestAnimationFrame(()=>this._renderStep()))}_mouseDown(e){let t=e.offsetX,s=e.offsetY;this._renderQueue.forEach(e=>e.onPress(t,s))}_mouseUp(e){let t=e.offsetX,s=e.offsetY;this._renderQueue.forEach(e=>e.onRelease(t,s))}_mouseMove(e){let t=e.offsetX,s=e.offsetY;this._renderQueue.forEach(e=>e.onMove(t,s))}}(u,1e3,700,"#036"),m=x.getContext(),v=new class extends i{constructor(e,t,s,i=1){super(e),this._cellsX=t,this._cellsY=s,this._ratio=i,this._collection=[],this._stepX=0,this._stepY=0,this._paddingV=.1,this._paddingH=.1,this._removeQueue=[],this._eventPropagation=!0}_gridRecalc(){this._stepX=(this._width-this._width*this._paddingH)/this._cellsX,this._stepY=(this._height-this._height*this._paddingV)/this._cellsY}setSize(e,t){super.setSize(e,t),this._gridRecalc()}getInstanceAddress(e){const t=this._collection.find(t=>t.instance===e);return{x:t.cellX,y:t.cellY}}updateItems(){this._collection.forEach(e=>{null!=e.updateX&&(e.cellX=e.updateX),null!=e.updateY&&(e.cellY=e.updateY)})}sortCollection(){this._collection.sort((e,t)=>t.cellY-e.cellY)}addItem(e,t,s){const i=this.getCellLocation(t,s);e.setContext(this._ctx),e.setPosition(i.x,i.y),e.scaleOnBackgroundWidth(this._stepX);const r={instance:e,cellX:t,cellY:s,updateX:void 0,updateY:void 0};this._collection.push(r)}getCell(e,t){return this._collection.find(s=>s.cellX===e&&s.cellY===t)}getInstance(e,t){return this.getCell(e,t).instance}getCellLocation(e,t){return{x:this._x+this._stepX*e+this._width*this._paddingV/2,y:this._y+this._stepY*t+this._height*this._paddingH/2}}removeItem(e){this._removeQueue.push(e)}onPress(e,t){super.onPress(e,t),this._eventPropagation&&this._collection.forEach(s=>s.instance.onPress(e,t))}onRelease(e,t){super.onRelease(e,t),this._eventPropagation&&this._collection.forEach(s=>s.instance.onRelease(e,t))}stopEventPropagation(){this._eventPropagation=!1}allowEventPropagation(){this._eventPropagation=!0}render(){this.sortCollection(),this._removeQueue.forEach(e=>{e.onRemove(),this._collection=this._collection.filter(t=>t.instance!=e)}),this._removeQueue=[],super.render(),this._collection.forEach(e=>e.instance.render())}}(m,7,7),y=new class{constructor(e,t,s,i,r){this._cellsX=e,this._cellsY=t,this._variety=s-1,this._minGroup=i,this._superGroup=r,this._field=[],this._empty_cell=-1,this._super_cell=s,this._group=void 0,this.init(),this.randomFill()}init(){for(let e=0;e<this._cellsY;e++)for(let t=0;t<this._cellsX;t++){let s={type:this._empty_cell,x:t,y:e,dx:t,dy:e};this._field.push(s)}}randomFill(){const e=this._field.filter(e=>e.type===this._empty_cell);return e.forEach(e=>e.type=r(0,this._variety)),e}getCell(e,t){return this._field.find(s=>s.x==e&&s.y==t)}setSuperCell(e,t){this.getCell(e,t).type=this._super_cell}isSupercell(e,t){return this.getCell(e,t).type==this._super_cell}_getGroup(e,t,s,i=[]){const r=e>=0&&e<this._cellsX,h=t>=0&&t<this._cellsY;return r&&h?void 0===s?(s=this.getCell(e,t).type,this._getGroup(e,t,s,i)):this.getCell(e,t).type!=s?i:i.find(s=>s.x==e&&s.y==t)?i:(i.push({x:e,y:t}),[{x:e+1,y:t},{x:e-1,y:t},{x:e,y:t+1},{x:e,y:t-1}].forEach(e=>this._getGroup(e.x,e.y,s,i)),i):i}getGroup(e,t){return this.getCell(e,t).type==this._super_cell?this._group=this.getCross(e,t):this._group=this._getGroup(e,t),this._group}getCross(e,t){this._group=[];for(let e=0;e<this._cellsX;e++)this._group.push({x:e,y:t});for(let t=0;t<this._cellsY;t++)this._group.push({x:e,y:t});return this._group}getRadius(e,t,s){const i=Math.max(e-s,0),r=Math.min(e+s,this._cellsX-1),h=Math.max(t-s,0),n=Math.min(t+s,this._cellsY-1);this._group=[];for(let e=i;e<=r;e++)for(let t=h;t<=n;t++)this._group.push({x:e,y:t});return this._group}getRow(e,t){const s=[];for(let e=0;e<this._cellsX;e++)s.push({x:e,y:t});return this._group=s,this._group}clearCell(e,t){this.getCell(e,t).type=this._empty_cell}clearGroup(){this._group.forEach(e=>this.clearCell(e.x,e.y))}isEmpty(e,t){return this.getCell(e,t).type==this._empty_cell}swapCells(e,t,s,i){let r=this.getCell(e,t),h=this.getCell(s,i);r.x=s,r.y=i,h.x=e,h.y=t}getChanges(){return this._field.filter(e=>(e.x!=e.dx||e.y!=e.dy)&&e.type!=this._empty_cell)}fixChanges(){this._field.forEach(e=>{e.dx=e.x,e.dy=e.y})}collapse(){this.clearGroup();for(let e=0;e<this._cellsX;e++){let t=0;for(let s=this._cellsY-1;s>=0;s--)this.isEmpty(e,s)?t++:this.swapCells(e,s,e,s+t)}}shuffle(){this._field.forEach(e=>{let t=r(0,this._field.length-1);this.swapCells(e.x,e.y,this._field[t].x,this._field[t].y)})}getMoves(){let e=0,t=this._field.slice(0);for(;t.length>0;){const s=t[0],i=this._getGroup(s.x,s.y);i.length>=this._minGroup&&e++,i.forEach(e=>{t=t.filter(t=>t.x!=e.x||t.y!=e.y)})}return e}}(7,7,6,3,4),b=new h(m,30,"#FFF","Roboto Slab","Ходы:"),k=new h(m,90,"#FFF","Roboto Slab"),I=new h(m,30,"#FFF","Roboto Slab","Очки:"),w=new h(m,50,"#FFF","Roboto Slab",0),P=new h(m,90,"#CFF","Roboto Slab"),H=new h(m,20,"#FFF","Roboto Slab"),S=new n(m,20,"#FFF","Roboto Slab","Перемешать (x".concat(g.shuffles,")")),E=new o(m,20,"#FFF","Roboto Slab","Бустер (x".concat(g.boosters,")")),C=new o(m),B=new class extends i{constructor(e){super(e),this._progress=0,this._progressX=0,this._progressY=0,this._progressWidth=0,this._progressStop=0,this._outerRadius=0,this._innerRadius=0,this._bar=void 0,this._border=0}_refresh(){super._refresh(),this._outerRadius=this._height/2,this._innerRadius=this._outerRadius-this._border,this._progressWidth=this._width-2*this._outerRadius,this._progressX=this._dx+this._outerRadius,this._progressY=this._dy+this._outerRadius}setProgress(e){e>1&&(e=1),this._progress=e,this._progressStop=this._progressWidth*e}setBarImage(e){this._bar=e}setBorder(e){this._border=e,this._refresh()}_clipper(e,t,s,i,r){this._ctx.beginPath(),this._ctx.arc(e,t,s,Math.PI/2,Math.PI+Math.PI/2,!1),this._ctx.arc(e+i,t,s,Math.PI+Math.PI/2,Math.PI/2,!1),this._ctx.closePath(),this._ctx.save(),this._ctx.clip(),r(),this._ctx.restore()}render(){this._clipper(this._progressX,this._progressY,this._outerRadius,this._progressWidth,()=>super.render()),this._clipper(this._progressX,this._progressY,this._innerRadius,this._progressStop,()=>this._ctx.drawImage(this._bar,this._dx,this._dy,this._width,this._height))}}(m),R=new i(m),T=new i(m),F=new i(m),X=new h(m,20,"#FFF","Roboto Slab","Прогресс");function Y(){v.setSize(500,500),v.setPosition(50,150),R.setAnchor(.5,.5),R.scaleOnBackgroundWidth(300),R.setPosition(780,300),b.setPosition(780,160),k.setAnchor(.5,.7),k.scaleOnBackgroundWidth(180),k.setText(g.moves),k.setPosition(780,300),I.setPosition(780,370),w.setPosition(780,410),P.setPosition(500,350),H.setPosition(150,130),H.setText("Доступно ходов: ".concat(y.getMoves())),S.setPosition(780,500),S.setAnchor(.5,.5),S.scaleOnBackgroundWidth(200),S.setSize(200,60),S.setClickHandler(O(g)),E.setPosition(780,570),E.setAnchor(.5,.5),E.scaleOnBackgroundWidth(200),E.setSize(200,60),E.setClickHandler(L(g)),C.setPosition(930,50),C.setAnchor(.5,.5),C.scaleOnBackgroundWidth(60),C.setClickHandler(Q()),B.setSize(300,25),B.setAnchor(.5,.5),B.setPosition(500,45),B.setBorder(3),B.setProgress(0),T.setSize(700,100),T.setAnchor(.5,0),T.setPosition(500,0),F.setSize(400,70),F.setAnchor(.5,0),F.setPosition(500,0),X.setPosition(500,15);for(var e=0;e<7;e++)for(var t=0;t<7;t++){var s=d(f,y.getCell(e,t).type);s.setClickHandler(M(g)),v.addItem(s,e,t)}var i,r,h,n;x.addLayer(v),x.addLayer(R),x.addLayer(b),x.addLayer(k),x.addLayer(I),x.addLayer(w),x.addLayer(H),x.addLayer(P),x.addLayer(S),x.addLayer(E),x.addLayer(T),x.addLayer(F),x.addLayer(X),x.addLayer(B),x.addLayer(C),x.addTask((i=g,r=v,h=y,n=f,function(){if(i.isPressed){if(i.address=r.getInstanceAddress(i.target),i.isBoosted?(i.group=h.getRadius(i.address.x,i.address.y,1),i.boosters--,E.setText("Бустер (x".concat(g.boosters,")"))):(i.supercell=h.isSupercell(i.address.x,i.address.y),i.group=h.getGroup(i.address.x,i.address.y)),i.group.length<3)return void(i.isPressed=!1);z(),i.group=i.group.map((function(e){return r.getCell(e.x,e.y)})),i.group.forEach((function(e){return e.instance.addSerialTask(function(e,t,s,i){let r=e;return t<0&&(t=0),e=>(r-=(s+i)/60,r<t&&(r=t),e._alpha=r,r<=t)}(1,.4,1,2))})),i.isPressed=!1,i.isRemoving=!0,i.moves--,i.score+=Math.pow(i.group.length,2)}if(i.isRemoving)i.isRemoving=!1,i.group.forEach((function(e){e.instance.getSerialQueueSize()>0?i.isRemoving=!0:r.removeItem(e.instance)})),i.isRemoving||(h.collapse(),i.changes=h.getChanges(),i.changes=i.changes.map((function(e){var t=r.getCell(e.dx,e.dy),s=r.getCellLocation(e.x,e.y);return t.instance.addSerialTask(c(s.x,s.y,100,300)),t.updateX=e.x,t.updateY=e.y,t})),i.isMoving=!0);else if(i.isMoving&&(i.isMoving=!1,i.changes.forEach((function(e){e.instance.getSerialQueueSize()>0&&(i.isMoving=!0)})),!i.isMoving))if(r.updateItems(),h.randomFill().forEach((function(e){var t=d(n,e.type);t.setClickHandler(M(g)),r.addItem(t,e.x,e.y)})),k.setText(g.moves),w.setText(i.score),B.setProgress(i.score/2e3),i.score>=2e3)P.setText("Вы победили");else if(0==i.moves)P.setText("Вы проиграли");else{h.fixChanges();var e=h.getMoves();H.setText("Доступно ходов: ".concat(h.getMoves())),i.group.length>=4&&!i.isBoosted&&!i.supercell&&!i.isShuffling&&(h.setSuperCell(i.address.x,i.address.y),r.getCell(i.address.x,i.address.y).instance.addParallelTask(function(e){const t=60/e;let s=!1,i=0;return e=>(i+=1,i==t&&(i=0,s=!s),e._alpha=1*s,!1)}(20))),i.shuffles||i.boosters||e||P.setText("Вы проиграли"),i.isBoosted=!1,E.reset(),i.isShuffling=!1,A()}i.isShuffling&&!i.isMoving&&(z(),h.shuffle(),i.changes=[],h._field.forEach((function(e){var t=r.getCell(e.dx,e.dy),s=r.getCellLocation(e.x,e.y);t.instance.addSerialTask(c(s.x,s.y,100,300)),t.updateX=e.x,t.updateY=e.y,i.changes.push(t)})),i.isMoving=!0)})),x.renderEngineStart()}var M=function(e){return function(t){e.isPressed=!0,e.target=t}},Q=function(){return function(e){e.getState()?(P.setText("Пауза"),z()):(P.setText(""),A())}},L=function(e){return function(t){t.getState()&&e.boosters>0?e.isBoosted=!0:e.isBoosted=!1}},O=function(e){return function(t){0!=e.shuffles&&(e.shuffles--,t.setText("Перемешать (x".concat(g.shuffles,")")),e.isShuffling=!0)}},z=function(){v.stopEventPropagation(),S.disableEvents(),E.disableEvents()},A=function(){v.allowEventPropagation(),S.enableEvents(),g.boosters>0&&E.enableEvents()};Promise.all([a(s(1)).then((function(e){return p=e})),a(s(2)).then((function(e){return v.setBackgroundImage(e)})),a(s(3)).then((function(e){return k.setBackgroundImage(e)})),a(s(4)).then((function(e){return B.setBackgroundImage(e)})),a(s(5)).then((function(e){return B.setBarImage(e)})),a(s(6)).then((function(e){return R.setBackgroundImage(e)})),a(s(7)).then((function(e){return T.setBackgroundImage(e)})),a(s(8)).then((function(e){return x.setBackgroundImage(e)})),a(s(9)).then((function(e){return F.setBackgroundImage(e)})),a(s(10)).then((function(e){return C.setBaseImage(e)})),a(s(11)).then((function(e){return C.setHoverImage(e)})),a(s(12)).then((function(e){return C.setPressImage(e)})),a(s(13)).then((function(e){S.setBaseImage(e),E.setBaseImage(e)})),a(s(14)).then((function(e){S.setHoverImage(e),E.setHoverImage(e)})),a(s(15)).then((function(e){S.setPressImage(e),E.setPressImage(e)}))]).then((function(){(function(e,t,s,i=0){const h=new Array;for(let n=0;n<t;n++){let t=r(i,s),n=r(i,s),o=r(i,s);h.push(l(e,t,n,o))}return new Promise(e=>{Promise.all(h).then(t=>e(t))})})(p,6,200).then((function(e){f=e,Y()}))})).catch((function(e){return console.log(e)}))}]);